# XLSX文件查看器和编辑器

## 项目概述
这是一个基于Web的XLSX文件查看器和编辑器，主要用于处理和匹配电子元件的物料清单（BOM）。该项目允许用户上传Excel或CSV文件，进行格式整理，执行物料匹配，并管理匹配规则。

## 主要功能
1. 文件上传和解析：支持XLSX、XLS和CSV格式。
2. 表格显示：将上传的文件内容显示为可编辑的HTML表格。
3. 格式整理：根据预定义的列标题（Designator, Comment, Footprint, Quantity）整理表格结构。
4. 物料匹配：
   - 基于预定义规则匹配Comment（名称）和Footprint（封装）。
   - 添加"整理后的名称"和"整理后的封装"列。
   - 未匹配项显示为绿色背景。
5. 规则管理：
   - 通过单独的规则编辑器页面管理匹配规则。
   - 支持添加、编辑、删除规则。
   - 规则分为"名称规则"和"封装规则"两类。
6. 实时编辑：表格单元格支持实时编辑。
7. 右键菜单：支持通过右键菜单快速添加新规则。
8. 数据持久化：使用IndexedDB存储规则数据。
9. 导入/导出规则：支持将规则导出为Excel文件，以及从Excel文件导入规则。

## 技术栈
- 前端：HTML5, CSS3, JavaScript (ES6+)
- 库和框架：
  - XLSX.js: 用于解析和生成Excel文件
  - PapaParse: 用于解析CSV文件
  - IndexedDB: 用于客户端数据存储

## 项目结构
- `index.html`: 主页面，包含文件上传和表格显示功能
- `rules.html`: 规则编辑器页面
- `script.js`: 主要的JavaScript逻辑，包含文件处理、表格操作和物料匹配功能
- `rules.js`: 规则管理相关的JavaScript逻辑

## 如何使用
1. 克隆或下载项目代码。
2. 使用现代浏览器（如Chrome、Firefox、Edge等）打开`index.html`文件。
3. 上传XLSX、XLS或CSV格式的物料清单文件。
4. 使用"格式整理"按钮整理表格结构。
5. 使用"物料匹配"按钮执行自动匹配。
6. 点击"编辑规则"打开规则编辑器，管理匹配规则。
7. 在主表格中，可以直接编辑单元格，右键单击可以快速添加新规则。

## 开发说明
- 本项目使用原生JavaScript开发，无需额外的构建步骤。
- 确保在开发过程中使用现代浏览器，并启用控制台以查看日志输出。
- 对于大型数据集，可能需要优化性能，考虑使用虚拟滚动或分页加载。

## 未来改进计划
- 优化大数据量处理性能
- 添加更多的数据验证和错误处理
- 实现更复杂的匹配算法
- 添加用户认证和多用户支持
- 开发服务器端组件，实现更安全的数据存储和处理

## 贡献指南
欢迎贡献代码、报告问题或提出新功能建议。请遵循以下步骤：
1. Fork 本仓库
2. 创建您的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交您的更改 (`git commit -m 'Add some AmazingFeature'`)
4. 将您的更改推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开一个 Pull Request

## 许可证
[MIT License](https://opensource.org/licenses/MIT)

## 联系方式
如有任何问题或建议，请联系项目维护者。

---

最后更新日期：[当前日期]